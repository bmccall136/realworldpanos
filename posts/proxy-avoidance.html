<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Beating Student Proxy Sites Without Playing Whack-a-Mole (Custom App-ID)</title>
  <meta name="description" content="Stop chasing proxy domains. Detect the shared proxy framework scaffolding (Scramjet, Ultraviolet, Rammerhead, etc.) with a custom PAN-OS Application signature so the proxies become non-functional." />

  <!-- Site dark theme -->
  <link rel="stylesheet" href="../assets/css/site.css">

  <style>
    .post { margin-top: 18px; }
    .chips { display:flex; flex-wrap:wrap; gap:10px; margin: 14px 0 6px; }
    .chip { border:1px solid rgba(255,255,255,.12); color: rgba(255,255,255,.72); padding:6px 10px; border-radius: 999px; font-size: 13px; }
    .post h1 { margin: 14px 0 6px; line-height: 1.1; }
    .post h2 { margin: 26px 0 10px; }
    .post p { color: rgba(255,255,255,.72); }
    .callout {
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      border-radius: 14px;
      padding: 14px 14px;
      margin: 14px 0;
      color: rgba(255,255,255,.75);
    }
    .callout strong { color: rgba(255,255,255,.92); }
    .figure { margin: 14px 0 22px; }
    .figure img {
      width: 100%;
      height: auto;
      display: block;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.35);
    }
    .caption { margin-top: 8px; font-size: 13px; color: rgba(255,255,255,.55); }
    pre, code {
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 12px;
      color: rgba(255,255,255,.85);
    }
    pre { padding: 12px 12px; overflow:auto; }
    code { padding: 2px 8px; }
    .hr { margin: 22px 0; }
  </style>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-K3FHP6L4TN"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-K3FHP6L4TN');
  </script>
</head>

<body>
  <div class="topbar">
    <div class="topbar-inner">
      <div class="brand"><a href="../index.html">RealWorldPANOS</a></div>
      <nav class="nav">
        <a href="../index.html#posts">Posts</a>
        <a href="../index.html#about">About</a>
        <a href="../index.html#contact">Contact</a>
      </nav>
    </div>
  </div>

  <div class="wrap post">
    <div class="chips">
      <span class="chip">PAN-OS</span>
      <span class="chip">K-12 Security</span>
      <span class="chip">App-ID</span>
      <span class="chip">URL Filtering</span>
      <span class="chip">Proxy Avoidance</span>
    </div>

    <h1>Beating Student Proxy Sites Without Playing Whack-a-Mole</h1>
    <p class="lead">
      Proxy frameworks (Utopia, Lumi, Scramjet, Secured, Arsenic, Ultraviolet, Rammerhead, etc.) don’t win because they’re “new” —
      they win because they rotate domains faster than you can block them. This is a production pattern that breaks the engine instead of chasing the paint job.
    </p>

    <div class="hr"></div>

    <h2>The problem</h2>
    <p>
      K-12 environments are getting hammered with proxy sites. Block one, two more appear. URL filtering often struggles because these sites
      hide inside pages that look legitimate, and categorization is frequently wrong. Domain-based blocking becomes a treadmill.
    </p>

    <div class="callout">
      <strong>Goal:</strong> Don’t chase domains. Make the proxy frameworks <strong>non-functional</strong> by preventing their core scaffolding from loading.
    </div>

    <h2>The shift: stop the engine, not the paint job</h2>
    <p>
      Many of these proxy sites are just different skins built on the same small set of JavaScript frameworks and “skeleton” resources:
      loaders, bundled assets, workers, handlers, and framework-specific paths that keep showing up across families.
    </p>
    <p>
      If those core resources can’t load, the proxy can’t initialize — even if the page itself still opens.
    </p>

    <div class="hr"></div>

    <h2>The solution: custom Application + signatures</h2>
    <p>
      We built a custom Palo Alto Networks <strong>Application</strong> and a set of <strong>signatures</strong> matching those recurring framework resources.
      It took refinement (and yes, a couple early false positives that we corrected), but the end result has been solid.
    </p>

    <div class="figure">
      <img src="../assets/img/1.png" alt="Palo Alto custom application configuration named Proxy Avoidance with risk and characteristics selected." />
      <div class="caption">Custom Application: <strong>Proxy Avoidance</strong> — aggregated detection across multiple student proxy frameworks.</div>
    </div>

    <div class="figure">
      <img src="../assets/img/2.png" alt="Signatures list in Palo Alto showing multiple proxy-related signature names." />
      <div class="caption">Signature set: per-framework “core” signatures plus a shared signature for common components.</div>
    </div>

    <h2>What we match (examples)</h2>
    <p>
      Below are examples of signature logic matching recurring framework resources.
      The value is consistency: domains change constantly, but the scaffolding stays recognizable.
    </p>

    <div class="figure">
      <img src="../assets/img/3.png" alt="Signature conditions matching WISP-related scaffolding and bundled JavaScript resources." />
      <div class="caption"><strong>proxy-wisp-core</strong> — WISP scaffolding paths (loader/bundle endpoints).</div>
    </div>

    <div class="figure">
      <img src="../assets/img/4.png" alt="Signature conditions matching Utopia-related paths and JavaScript resources." />
      <div class="caption"><strong>proxy-utopia-core</strong> — recurring Utopia resources observed across clones.</div>
    </div>

    <div class="figure">
      <img src="../assets/img/5.png" alt="Signature conditions matching Scramjet packaged assets and worker/bundle resources." />
      <div class="caption"><strong>proxy-scram-core</strong> — Scramjet packaged assets + worker/bundle resources.</div>
    </div>

    <div class="figure">
      <img src="../assets/img/6.png" alt="Signature conditions matching Lumi-related framework bundle and handler endpoints." />
      <div class="caption"><strong>proxy-lumi-core</strong> — Lumi framework bundle/handler endpoints.</div>
    </div>

    <div class="figure">
      <img src="../assets/img/7.png" alt="Signature conditions matching Wordplus JavaScript resources such as loading and bundle files." />
      <div class="caption"><strong>proxy-wordplus-core</strong> — Wordplus framework JS resources frequently reused.</div>
    </div>

    <div class="figure">
      <img src="../assets/img/8.png" alt="Signature conditions matching Rammerhead dashboard and worker resources." />
      <div class="caption"><strong>proxy-rammer-dashboard</strong> — Rammerhead dashboard + worker resources.</div>
    </div>

    <div class="figure">
      <img src="../assets/img/9.png" alt="Signature conditions matching Secured framework JavaScript including messages and announcements." />
      <div class="caption"><strong>proxy-secured-core</strong> — Secured framework JS resources observed across deployments.</div>
    </div>

    <div class="figure">
      <img src="../assets/img/proxy-10.png" alt="Signature conditions matching shared WebSocket and common proxy framework paths." />
      <div class="caption"><strong>proxy-ws-core</strong> — shared WebSocket + common framework paths (useful across families).</div>
    </div>

    <h2>What “success” looks like</h2>
    <p>
      This approach doesn’t always produce a traditional block page — because we’re not necessarily blocking the site itself.
      Instead, the proxy becomes <strong>broken</strong> because the framework can’t initialize.
    </p>

    <div class="callout">
      <strong>Takeaway:</strong> You can’t win Whack-a-Mole by chasing domains forever.<br/>
      You win by identifying and disrupting the shared scaffolding those proxy frameworks depend on.
    </div>

    <div class="hr"></div>

    <p class="muted" style="margin:0;">
      This post describes an operational pattern (“how to think”). Implementation details should be tested safely in your environment.
    </p>

    <div class="footer" style="margin-top:22px;">
      All views are my own and do not represent my employer. © 2025 RealWorldPANOS
    </div>
  </div>
</body>
</html>
