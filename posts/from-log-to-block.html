<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>From Log to Block: Auto-Blocking External Threat Sources with PAN-OS</title>
  <meta name="description" content="Use log forwarding filters + tagging + Dynamic Address Groups to auto-block external threat sources." />

  <!-- Site dark theme -->
  <link rel="stylesheet" href="../assets/css/site.css">

  <style>
    .post { margin-top: 18px; }
    .chips { display:flex; flex-wrap:wrap; gap:10px; margin: 14px 0 6px; }
    .chip { border:1px solid rgba(255,255,255,.12); color: rgba(255,255,255,.72); padding:6px 10px; border-radius: 999px; font-size: 13px; }
    .post h1 { margin: 14px 0 6px; line-height: 1.1; }
    .post h2 { margin: 26px 0 10px; }
    .post p { color: rgba(255,255,255,.72); }
    .callout {
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      border-radius: 14px;
      padding: 14px 14px;
      margin: 14px 0;
      color: rgba(255,255,255,.75);
    }
    .callout strong { color: rgba(255,255,255,.92); }
    .figure { margin: 14px 0 22px; }
    .figure img {
      width: 100%;
      height: auto;
      display: block;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.35);
    }
    .caption { margin-top: 8px; font-size: 13px; color: rgba(255,255,255,.55); }
    pre, code {
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 12px;
      color: rgba(255,255,255,.85);
    }
    pre { padding: 12px 12px; overflow:auto; }
    code { padding: 2px 8px; }
    .hr { margin: 22px 0; }
  </style>
  <!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-K3FHP6L4TN"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-XXXXXXXXXX');
</script>
</head>

<body>
  <div class="topbar">
    <div class="topbar-inner">
      <div class="brand"><a href="../index.html">RealWorldPANOS</a></div>
      <nav class="nav">
        <a href="../index.html#posts">Posts</a>
        <a href="../index.html#about">About</a>
        <a href="../index.html#contact">Contact</a>
      </nav>
    </div>
  </div>

  <div class="wrap post">
    <div class="chips">
      <span class="chip">PAN-OS</span>
      <span class="chip">Operations</span>
      <span class="chip">Threat Prevention</span>
      <span class="chip">Dynamic Address Groups</span>
      <span class="chip">Log Forwarding / Tagging</span>
    </div>

    <h1>From Log to Block: Auto-Blocking External Threat Sources with PAN-OS</h1>
    <p class="lead">
      A production pattern: tag external source IPs on meaningful denied threats, feed those tags into a Dynamic Address Group,
      and enforce a high-priority global block rule.
    </p>

    <div class="hr"></div>

    <h2>The problem</h2>
    <p>
      Internet-facing services attract constant hostile traffic. Even when traffic is denied, repeat offenders create noise and overhead:
      repeated sessions, repeated inspection, repeated log volume.
    </p>

    <div class="callout">
      <strong>Goal:</strong> If an external source IP triggers a meaningful denied threat (medium/high), it should be blocked everywhere automatically —
      without external tooling and without manual list maintenance.
    </div>

    <h2>The design pattern</h2>
    <ul>
      <li><strong>Threat log forwarding filter</strong> matches denied medium/high threat events from the outside.</li>
      <li><strong>Tagging action</strong> applies a tag to the <strong>source address</strong> at log time.</li>
      <li><strong>Dynamic Address Group (DAG)</strong> matches any IP with that tag.</li>
      <li><strong>High-priority security policy</strong> drops traffic from that DAG to anything.</li>
    </ul>

    <div class="hr"></div>

    <h2>1) Log forwarding filter (Threat logs)</h2>
    <p>Create a log forwarding profile match list for <code>Log Type: threat</code> and filter for real, actionable abuse.</p>

    <div class="figure">
      <img src="../assets/img/01-threat-log-forwarding-filter.png" alt="Threat log forwarding filter match list" />
      <div class="caption">Threat Log Forwarding profile match list tuned to catch meaningful denied threats from outside sources.</div>
    </div>

    <ul>
      <li>Source zone = outside / untrusted</li>
      <li>Action = denied / dropped (based on your logging model)</li>
      <li>Severity = medium/high (tune for your environment)</li>
      <li>Exclude known infrastructure and expected traffic patterns</li>
    </ul>

    <h2>2) Tag the source IP (built-in tagging action)</h2>
    <p>The built-in action tags the <strong>Source Address</strong> (not a user, not a destination). The firewall observes an event and immediately turns it into an enforcement input.</p>

    <div class="figure">
      <img src="../assets/img/02-tagging-action-source-ip.png" alt="Built-in tagging action targeting Source Address" />
      <div class="caption">Built-in tagging action: target = Source Address; action = Add Tag.</div>
    </div>

    <h2>3) Dynamic Address Group (DAG)</h2>
    <p>Define a <strong>Dynamic Address Group</strong> that matches on the tag. As soon as the firewall registers the tag, that IP becomes a member of the DAG.</p>

    <div class="figure">
      <img src="../assets/img/03-dynamic-address-group.png" alt="Dynamic Address Group matching on tag" />
      <div class="caption">Dynamic Address Group configured to match the tag.</div>
    </div>

    <h2>4) Confirm it’s populating</h2>
    <p>Once tags start being applied, the DAG should fill quickly — especially if you’re protecting public IP space.</p>

    <div class="figure">
      <img src="../assets/img/04-dag-populated-ips.png" alt="DAG populated with registered IPs" />
      <div class="caption">DAG populated with registered IPs (tagged sources).</div>
    </div>

    <h2>5) High-priority block rule</h2>
    <p>Place a high-priority security rule near the top of the rulebase to drop traffic from the DAG to anything.</p>

    <div class="figure">
      <img src="../assets/img/05-high-priority-block-rule.png" alt="High-priority block rule using the DAG as source" />
      <div class="caption">High-priority block policy: Source = DAG; Destination = any; Action = drop.</div>
    </div>

    <h2>What this buys you</h2>
    <ul>
      <li><strong>Noise reduction:</strong> repeat offenders stop generating meaningful churn after the first hit.</li>
      <li><strong>Performance protection:</strong> known-bad sources get dropped early.</li>
      <li><strong>Self-updating enforcement:</strong> no manual lists, no external EDL hosting, no scripts required.</li>
    </ul>

    <div class="figure">
      <img src="../assets/img/06-deny-log-volume.png" alt="High deny volume demonstrating the value of auto-blocking" />
      <div class="caption">Example deny/log volume: this is the kind of flood this pattern cleans up fast.</div>
    </div>

    <h2>Guardrails</h2>
    <ul>
      <li><strong>Exclusions matter:</strong> don’t tag your own infrastructure, trusted scanners, or known 3rd-party services.</li>
      <li><strong>Severity threshold matters:</strong> medium+ works well in many environments, but tune aggressively.</li>
      <li><strong>Tag lifecycle matters:</strong> decide whether tags age out or get cleared manually.</li>
      <li><strong>Placement matters:</strong> keep the block rule high so it acts as an early containment gate.</li>
    </ul>

    <div class="hr"></div>

    <p class="muted" style="margin:0;">
      This post describes an operational pattern (“how to think”). Implementation details should be tested safely in your environment.
    </p>

    <div class="footer" style="margin-top:22px;">
      All views are my own and do not represent my employer. © 2025 RealWorldPANOS
    </div>
  </div>
</body>
</html>
